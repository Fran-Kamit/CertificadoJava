<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <head th:replace="fragments/header :: header">
    </head>
    <body>
        <div th:replace="fragments/navbar :: navbar"></div>
        <div class="container"><h1>Editar médico</h1></div>

        <!--Formulario para eliminar médico-->
        <div class="text-right mr-4">
                <form th:action="@{/medicos/eliminar/{id}(id=${medico.codigoIdentificacion})}" method="post">
                    <input type="hidden" name="_method" value="delete" />
                    <button type="submit" class="btn btn-danger" onclick="location.href='/medicos/listado-medicos'">Eliminar médico</button>
                </form> 
        </div>
        <!--Formulario para editar médico-->
        <form th:action="@{/medicos/actualizar/{id}(id=${medico.codigoIdentificacion})}" th:object="${medico}" method="post">
            <div class="row ml-2 mr-2">
                <!-- Código Identificación de médico-->
                <input type="hidden" th:value="${medico.codigoIdentificacion}" name="usuarCodigoIdentificacion" />
                <!--Nombre (oculto)-->
                <input type="hidden" id="usuarNombre" name="usuarNombre">
                <!--Apellidos (oculto)-->
                <input type="hidden" id="usuarApellidos" name="usuarApellidos">
                <!--Número Colegiado-->
                <div class="col-md-6 col-lg-4 mb-3">
                    <label for="medicNumeroColegiado">Número de colegiado:*</label>
                    <input type="number" class="form-control" th:field="*{medicNumeroColegiado}" id="medicNumeroColegiado" name="medicNumeroColegiado" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" maxlength="9"  required />
                </div>
                <!--Especialidad-->
                <div class="col-md-6 col-lg-4 mb-3">
                    <label for="medicEspecialidad">Especialidad:</label>
                    <input type="text" class="form-control" th:field="*{medicEspecialidad}" id="medicEspecialidad" name="medicEspecialidad"/>
                </div>
                <!--Cargo-->
                <div class="col-md-6 col-lg-4 mb-3">
                    <label for="medicCargo">Cargo:</label>
                    <input type="text" class="form-control" th:field="*{medicCargo}" id="medicCargo" name="medicCargo"/>
                </div>
                <div class="col-md-6 col-lg-4 mb-3">
                </div>
            </div>
            <div class="text-center"><br/>
                <button type="submit" class="btn btn-primary">Aplicar</button>
                <button type="button" class="btn btn-secondary" onclick="location.href='/medicos/listado-medicos'">Cancelar</button>
            </div>
        </form>
        <script>
            const codigoIdentificacionSelect = document.getElementById('usuarCodigoIdentificacion');
            const nombreInput = document.getElementById('usuarNombre');
            const apellidosInput = document.getElementById('usuarApellidos');

            codigoIdentificacionSelect.addEventListener('change', () => {
                const opcionSelec = codigoIdentificacionSelect.options[codigoIdentificacionSelect.selectedIndex];
                const usuarioMemoria = opcionSelec.text.split(' - ');

                const nombre = usuarioMemoria[0].split(', ')[1];
                const apellidos = usuarioMemoria[0].split(', ')[0];

                nombreInput.value = nombre;
                apellidosInput.value = apellidos;
            });
        </script>
    </body>
</html>